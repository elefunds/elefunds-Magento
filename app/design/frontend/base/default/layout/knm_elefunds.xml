<?xml version="1.0"?>
<!--
    Defines when to call specific Blocks (from Block/..)
 -->
<layout version="0.1.0">
    <checkout_onepage_index>
        <reference name="head">
            <!--TODO: Delaying load of libraries till end moment? In case of Payment Method dependance? -->
            <action method="addItem"><type>skin_css</type><name>css/knm_elefunds/elefunds_magento.css</name></action>		
            <block type="elefunds/page_head" name="elefunds.head"/>
        </reference>
    </checkout_onepage_index>
    
    <checkout_onepage_review>
        <reference name="checkout.onepage.review.info.items.after">
            <block type="elefunds/checkout_banner" name="checkout.onepage.elefunds.banner" as="elefunds.banner" template="knm/elefunds/checkout/onepage/review/donation_banner.phtml" />
        </reference>
    </checkout_onepage_review>
    
    <checkout_onepage_success>
        <!-- head was added by code, so it will be loaded only if a donation was done! -->
        <reference name="content">
            <block type="elefunds/checkout_socialmedia" name="checkout.onepage.sucess.socialmedia" after="checkout.success" as="elefunds.socialmedia" template="knm/elefunds/checkout/onepage/socialmedia.phtml" />
        </reference>
    </checkout_onepage_success> 
    
    <!-- Elefunds billing changes -->
    <sales_email_order_items>
        <reference name="additional.product.info">
            <block type="elefunds/sales_order_email" name="donation.description" template="knm/elefunds/mail/description.phtml"/>
        </reference>
    </sales_email_order_items>
    
    <sales_email_order_invoice_items>
        <reference name="additional.product.info">
            <block type="core/template" name="donation.description" template="knm/elefunds/mail/description.phtml"/>
        </reference>    
    </sales_email_order_invoice_items>
    
    <sales_email_order_shipment_items>
        <reference name="additional.product.info">
            <block type="core/template" name="donation.description" template="knm/elefunds/mail/description.phtml"/>
        </reference>    
    </sales_email_order_shipment_items>
    
    <sales_email_order_creditmemo_items>
        <reference name="additional.product.info">
            <block type="core/template" name="donation.description" template="knm/elefunds/mail/description.phtml"/>
        </reference>    
    </sales_email_order_creditmemo_items>
</layout>
